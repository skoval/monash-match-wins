<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Who Will Win?</title>
    <meta charset="utf-8" />
    <meta name="author" content="XITONG HE" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> 
    -->
    <link rel="icon" href="images/favicon.ico"  type='image/x-icon'/>
    <link rel="stylesheet" href="assets/animate.css" type="text/css" />
    <link rel="stylesheet" href="assets/monash-logo.css" type="text/css" />
    <link rel="stylesheet" href="assets/monash-brand.css" type="text/css" />
    <link rel="stylesheet" href="assets/monash-fonts.css" type="text/css" />
    <link rel="stylesheet" href="assets/styles.css" type="text/css" />
    <link rel="stylesheet" href="assets/custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">






background-image: url(images/tennis.png)
background-size: cover
class: hide-slide-number split-70 title-slide
count: false

.column.shade_black[.content[

&lt;br&gt;

# .outline-text[Who Will Win?]

&lt;br&gt;
*Predicting match results in professional tennis*

&lt;br&gt;
&lt;br&gt;
Supervised by Stephanie Kovalchik from Zelus Analytics

&lt;br&gt;
&lt;br&gt;

&lt;br&gt;
&lt;br&gt;
XITONG HE 

&lt;br&gt;
.bottom_abs.width100[

June 11 2021

&lt;br&gt;
]


]]



&lt;div class="column transition monash-m-new delay-0s" style="clip-path:url(#swipe__clip-path);"&gt;
&lt;div class="background-image" style="background-image:url('images/large.png');background-position: center;background-size:cover;margin-left:3px;"&gt;
&lt;svg class="clip-svg absolute"&gt;
&lt;defs&gt;
&lt;clipPath id="swipe__clip-path" clipPathUnits="objectBoundingBox"&gt;
&lt;polygon points="0.5745 0, 0.5 0.33, 0.42 0, 0 0, 0 1, 0.27 1, 0.27 0.59, 0.37 1, 0.634 1, 0.736 0.59, 0.736 1, 1 1, 1 0, 0.5745 0" /&gt;
&lt;/clipPath&gt;
&lt;/defs&gt;	
&lt;/svg&gt;
&lt;/div&gt;
&lt;/div&gt;




---
# Motivation &lt;svg viewBox="0 0 352 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M176 80c-52.94 0-96 43.06-96 96 0 8.84 7.16 16 16 16s16-7.16 16-16c0-35.3 28.72-64 64-64 8.84 0 16-7.16 16-16s-7.16-16-16-16zM96.06 459.17c0 3.15.93 6.22 2.68 8.84l24.51 36.84c2.97 4.46 7.97 7.14 13.32 7.14h78.85c5.36 0 10.36-2.68 13.32-7.14l24.51-36.84c1.74-2.62 2.67-5.7 2.68-8.84l.05-43.18H96.02l.04 43.18zM176 0C73.72 0 0 82.97 0 176c0 44.37 16.45 84.85 43.56 115.78 16.64 18.99 42.74 58.8 52.42 92.16v.06h48v-.12c-.01-4.77-.72-9.51-2.15-14.07-5.59-17.81-22.82-64.77-62.17-109.67-20.54-23.43-31.52-53.15-31.61-84.14-.2-73.64 59.67-128 127.95-128 70.58 0 128 57.42 128 128 0 30.97-11.24 60.85-31.65 84.14-39.11 44.61-56.42 91.47-62.1 109.46a47.507 47.507 0 0 0-2.22 14.3v.1h48v-.05c9.68-33.37 35.78-73.18 52.42-92.16C335.55 260.85 352 220.37 352 176 352 78.8 273.2 0 176 0z"&gt;&lt;/path&gt;&lt;/svg&gt;

- .monash-orange2[Main objective:] develop and evaluate different approaches for predicting the win/loss results of tennis matches at the professional level.
- .monash-orange2[Key goal:] account for the Head-To-Head effect
- .monash-orange2[Other features:]consider the variation of player's ability in the different surface courts

![](images/animated-tennis.gif)
---
# Data description &lt;svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"&gt;&lt;/path&gt;&lt;/svg&gt;

- `atp_results` and `wta_results` are used in this report and the structure is shown as below:

&lt;table class="table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Key match informatiom&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Variable &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Description &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Surface &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Match Surface &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Player1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Match Winner &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Player2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Match Loser &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tier &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Professional tennis tour tournaments &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

- However, the final model data is constructed by filtering the top 100 players from  from atpworldtour.com and wtatennis.com
  - develop a general framework more quickly by focusing on a relevant but smaller-scale problem.
  - Eg: total number of matches in **`atp`** : `\(36,000 \to 4,500\)`
  
---
# Head-To-Head &lt;svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M448.61 225.62c26.87.18 35.57-7.43 38.92-12.37 12.47-16.32-7.06-47.6-52.85-71.33 17.76-33.58 30.11-63.68 36.34-85.3 3.38-11.83 1.09-19 .45-20.25-1.72 10.52-15.85 48.46-48.2 100.05-25-11.22-56.52-20.1-93.77-23.8-8.94-16.94-34.88-63.86-60.48-88.93C252.18 7.14 238.7 1.07 228.18.22h-.05c-13.83-1.55-22.67 5.85-27.4 11-17.2 18.53-24.33 48.87-25 84.07-7.24-12.35-17.17-24.63-28.5-25.93h-.18c-20.66-3.48-38.39 29.22-36 81.29-38.36 1.38-71 5.75-93 11.23-9.9 2.45-16.22 7.27-17.76 9.72 1-.38 22.4-9.22 111.56-9.22 5.22 53 29.75 101.82 26 93.19-9.73 15.4-38.24 62.36-47.31 97.7-5.87 22.88-4.37 37.61.15 47.14 5.57 12.75 16.41 16.72 23.2 18.26 25 5.71 55.38-3.63 86.7-21.14-7.53 12.84-13.9 28.51-9.06 39.34 7.31 19.65 44.49 18.66 88.44-9.45 20.18 32.18 40.07 57.94 55.7 74.12a39.79 39.79 0 0 0 8.75 7.09c5.14 3.21 8.58 3.37 8.58 3.37-8.24-6.75-34-38-62.54-91.78 22.22-16 45.65-38.87 67.47-69.27 122.82 4.6 143.29-24.76 148-31.64 14.67-19.88 3.43-57.44-57.32-93.69zm-77.85 106.22c23.81-37.71 30.34-67.77 29.45-92.33 27.86 17.57 47.18 37.58 49.06 58.83 1.14 12.93-8.1 29.12-78.51 33.5zM216.9 387.69c9.76-6.23 19.53-13.12 29.2-20.49 6.68 13.33 13.6 26.1 20.6 38.19-40.6 21.86-68.84 12.76-49.8-17.7zm215-171.35c-10.29-5.34-21.16-10.34-32.38-15.05a722.459 722.459 0 0 0 22.74-36.9c39.06 24.1 45.9 53.18 9.64 51.95zM279.18 398c-5.51-11.35-11-23.5-16.5-36.44 43.25 1.27 62.42-18.73 63.28-20.41 0 .07-25 15.64-62.53 12.25a718.78 718.78 0 0 0 85.06-84q13.06-15.31 24.93-31.11c-.36-.29-1.54-3-16.51-12-51.7 60.27-102.34 98-132.75 115.92-20.59-11.18-40.84-31.78-55.71-61.49-20-39.92-30-82.39-31.57-116.07 12.3.91 25.27 2.17 38.85 3.88-22.29 36.8-14.39 63-13.47 64.23 0-.07-.95-29.17 20.14-59.57a695.23 695.23 0 0 0 44.67 152.84c.93-.38 1.84.88 18.67-8.25-26.33-74.47-33.76-138.17-34-173.43 20-12.42 48.18-19.8 81.63-17.81 44.57 2.67 86.36 15.25 116.32 30.71q-10.69 15.66-23.33 32.47C365.63 152 339.1 145.84 337.5 146c.11 0 25.9 14.07 41.52 47.22a717.63 717.63 0 0 0-115.34-31.71 646.608 646.608 0 0 0-39.39-6.05c-.07.45-1.81 1.85-2.16 20.33C300 190.28 358.78 215.68 389.36 233c.74 23.55-6.95 51.61-25.41 79.57-24.6 37.31-56.39 67.23-84.77 85.43zm27.4-287c-44.56-1.66-73.58 7.43-94.69 20.67 2-52.3 21.31-76.38 38.21-75.28C267 52.15 305 108.55 306.58 111zm-130.65 3.1c.48 12.11 1.59 24.62 3.21 37.28-14.55-.85-28.74-1.25-42.4-1.26-.08 3.24-.12-51 24.67-49.59h.09c5.76 1.09 10.63 6.88 14.43 13.57zm-28.06 162c20.76 39.7 43.3 60.57 65.25 72.31-46.79 24.76-77.53 20-84.92 4.51-.2-.21-11.13-15.3 19.67-76.81zm210.06 74.8"&gt;&lt;/path&gt;&lt;/svg&gt;

- matchup effect of two specific players meeting in the matches. 
  - The player's ability in tennis
  - Other factor: the playing style, familiar with their opponents or psychological impact?
  


- The sample size of head-to-heads in professional tennis matches is small


&lt;table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;The number of matches on different surface in ATP&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; Surface &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; match &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; met=1 &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; met=2 &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; met&amp;gt;=3 &lt;/th&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; per(met&amp;gt;=3) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Clay &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 11633 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 9236 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 1594 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 803 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 6.90% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Grass &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 4615 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 4223 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 312 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 80 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 1.73% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Hard &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 20682 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 14483 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 3628 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 2571 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 12.43% &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Example &lt;svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.8-3.1-19.4 5.3-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zm-235.9-72.9c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3zm160 0c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3z"&gt;&lt;/path&gt;&lt;/svg&gt;
.cbox[
###### One of the famous example is: **`Federer–Nadal rivalry`**
]
&lt;br&gt;
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/nadal.png" alt="Rafael Nadal VS Roger Federer" width="50%" height="40%" /&gt;
&lt;p class="caption"&gt;Rafael Nadal VS Roger Federer&lt;/p&gt;
&lt;/div&gt;
&lt;br&gt;


&lt;table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; Player0 &lt;/th&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; Player1 &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; total_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p0_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p1_count &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Rafael Nadal &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Roger Federer &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 7 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Approach

The main approaches used in this project fell into two categories:
- Paired Comparison Model
  - Bradley-Terry Model
- Bayesian Paired Comparison Model
  - Head-To-Head effect model
  - Mixed effect Model with surface random effect
  
&lt;br&gt;  
  
.cbox[
###### Overall, the main model is the *`Bradley-Terry`* model.
]

---
# Bradley-Terry Model
- is one of the most popular paired comparison models
- is the probability model that can predict the outcome of a paired comparison. 
&lt;center&gt;
`\(\mathrm{P}(\left[ i \mbox{ beats } j \right]=\frac{\exp({\lambda_{i} )}}{\exp({\lambda_{i}})+\exp(\lambda_j)}\)`
&lt;center&gt;

&lt;br&gt;
- Alternative way using logit function: 
&lt;center&gt;
`\(logit(P(i&gt;j))=log(\frac{P(i&gt;j)}{1-P(i&gt;j)})=\lambda_{i}-\lambda_{j}\)`
&lt;center&gt;
---
# Implementation &lt;svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"&gt;&lt;/path&gt;&lt;/svg&gt;

The main function for the BT model is `BTm` in `BradleyTerry2` package. 
&lt;br&gt;

```r
fit&lt;-BTm(cbind(p0_count,p1_count),Player0,Player1,~Player,id="Player",data=atp_match)
```
- `BTabilities`: extract the abilities of each player  on the log scale against with the baseline player.


```r
BTabilities(fit)
```
- `prediction` function: obtain predicted probability from BT model


```r
predict(fit,type="response")
# default predictions are of `log-odds` (probabilities on logit scale)
```

---
# Example (Nadal VS Federer) &lt;svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.8-3.1-19.4 5.3-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zm-235.9-72.9c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3zm160 0c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3z"&gt;&lt;/path&gt;&lt;/svg&gt;


- The estimated ability in the `ATP`
  - Baseline: Adrian Mannarino
&lt;br&gt;
&lt;br&gt;

&lt;center&gt;
![The estimated ability in each player](project_presentation_files/figure-html/atp-ability-1.png)

---
# Example (Nadal VS Federer) &lt;svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.8-3.1-19.4 5.3-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zm-235.9-72.9c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3zm160 0c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3z"&gt;&lt;/path&gt;&lt;/svg&gt;

- The estimated ability between Nadal and Federer
&lt;br&gt;
&lt;br&gt;
&lt;table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;The estimated ability&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; Player &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; Ability &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; SE &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Rafael Nadal &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 2.7039 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 0.2401 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Roger Federer &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 2.5289 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 0.2333 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;br&gt;
- The prediction from standard Bradley-Terry model
&lt;br&gt;
&lt;br&gt;
&lt;table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;The comparison between predicted and actual probability about Nadal wins&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; Player0 &lt;/th&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; Player1 &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; total_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p0_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p1_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p0_pred &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p0_act &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Rafael Nadal &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Roger Federer &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 0.5436 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 0.5625 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
# Head-To-Head Model &lt;svg viewBox="0 0 576 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z"&gt;&lt;/path&gt;&lt;/svg&gt;
- Further extension in Bradley-Terry model, cooperating with head-to-head effect.
&lt;br&gt;
&lt;br&gt;
`\(P(Win1)= \frac{\exp{(\lambda_1 - \lambda_0)}}{1 + \exp{(\lambda_1 - \lambda_1)}} \to \frac{\exp{(\lambda_1-\lambda_0+\delta_{1,0})}}{1+\exp{(\lambda_{1}-\lambda_{0}+\delta_{1,0})}}\)`

&lt;newline&gt;
where `\(\delta_{1,0}\)` is the H2H effect between player 1 and player 0
&lt;br&gt;
&lt;br&gt;
- Implemented within Stan code model statement
  - `sampling` function in `rstan`package: computes posterior samples via MCMC(Markov Chain Monte Carlo) method.

---
# Example  (Nadal VS Federer) &lt;svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.8-3.1-19.4 5.3-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zm-235.9-72.9c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3zm160 0c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3z"&gt;&lt;/path&gt;&lt;/svg&gt;

- Head-To-Head effect between Nadal and Federer
&lt;br&gt;

&lt;table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; player0 &lt;/th&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; player1 &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; h2h &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Rafael Nadal &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Roger Federer &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 0.022 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;br&gt;
- Surprisingly, the prediction from Head-To-Head effect model is the same as actual value
  - It can capture more flexibility like head-to-head effect compared with standard Bradley-Terry model
&lt;br&gt;

&lt;table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; player0 &lt;/th&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; player1 &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; total_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p1_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p1_pred &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p1_h2h_prob &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p1_bt_prob &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Rafael Nadal &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Roger Federer &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 0.4375 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 0.4564 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



---
# Mixed effect model

The extension of Bradley-Terry model with surface random effects can be simply represented as:

`\(\mathrm{Pr}\left[ i \mbox{ beats } j \right]=\frac{exp(\lambda_{i,s})}{exp(\lambda_{i,s})+exp(\lambda_{j,s})};\)`
`\(\lambda_{i,s}=\lambda_{i}+U_{i,s};\)` 

`\(s\)` represents different types of surface

&lt;br&gt;

- Implementation: **`bpc`** function in **`bpcs`** package


```r
fit&lt;-bpc(data = atp_surface,player0 = 'player0',player1 = 'player1',
    result_column = 'y',model_type = 'bt-U',cluster = 'Surface',iter = 3000)
```

---
# Example (Nadal VS Federer) &lt;svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.8-3.1-19.4 5.3-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zm-235.9-72.9c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3zm160 0c3.5 1.1 7.4-.5 9.3-3.7l9.5-17c7.7-13.7 19.2-21.6 31.5-21.6s23.8 7.9 31.5 21.6l9.5 17c2.1 3.7 6.2 4.7 9.3 3.7 3.6-1.1 6-4.5 5.7-8.3-3.3-42.1-32.2-71.4-56-71.4s-52.7 29.3-56 71.4c-.3 3.7 2.1 7.2 5.7 8.3z"&gt;&lt;/path&gt;&lt;/svg&gt;

- The estimated ability of Nadal in the clay court is higher than Federer
  - One of explanation for the small matchup effect between them 
&lt;br&gt;

&lt;table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Rafael Nadal VS Roger Federer&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; player0 &lt;/th&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; player1 &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p0_mean &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p1_mean &lt;/th&gt;
   &lt;th style="text-align:left;font-weight: bold;color: black !important;background-color: white !important;"&gt; Surface &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; total_count &lt;/th&gt;
   &lt;th style="text-align:right;font-weight: bold;color: black !important;background-color: white !important;"&gt; p0_count &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Rafael Nadal &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Roger Federer &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 1.24 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; -0.98 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; Clay &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: white !important;background-color: #2875a1 !important;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;br&gt;

&lt;svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm117.8-146.4c-10.2-8.5-25.3-7.1-33.8 3.1-20.8 25-51.5 39.4-84 39.4s-63.2-14.3-84-39.4c-8.5-10.2-23.7-11.5-33.8-3.1-10.2 8.5-11.5 23.6-3.1 33.8 30 36 74.1 56.6 120.9 56.6s90.9-20.6 120.9-56.6c8.5-10.2 7.1-25.3-3.1-33.8zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160-60c-25.7 0-55.9 16.9-59.9 42.1-1.7 11.2 11.5 18.2 19.8 10.8l9.5-8.5c14.8-13.2 46.2-13.2 61 0l9.5 8.5c8.5 7.4 21.6.3 19.8-10.8-3.8-25.2-34-42.1-59.7-42.1z"&gt;&lt;/path&gt;&lt;/svg&gt; Nadal has won 13 French Opens (the clay grand slam) and has a chance to win his 14th this week
---
# Conclusion: &lt;svg viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg" style="height:1em;fill:currentColor;position:relative;display:inline-block;top:.1em;"&gt;  [ comment ]  &lt;path d="M360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64zM192 208c-57.787 0-104-66.518-104-144h208c0 77.945-46.51 144-104 144z"&gt;&lt;/path&gt;&lt;/svg&gt;

- The model performance comparison:
&gt;Head-To-Head model
  &gt;&gt;Standard Bradley-Terry model
  &gt;&gt;&gt;Mixed effect model

&lt;br&gt;
- Further exploration:
 - Expanding the data set
 - Combing the Surface Factor and Head-to-Head Models
 - Addition factors: player ranking, Elo scores,...



---

background-image: url(images/tennis.png)
background-size: cover
class: hide-slide-number split-70
count: false

.column.shade_black[.content[

&lt;br&gt;&lt;br&gt;

## Acknowledgements

Slides produced using [Rmarkdown](https://github.com/rstudio/rmarkdown) with [xaringan](https://github.com/yihui/xaringan) styling. 

# Questions?


&lt;br&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;This work is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"&gt;Creative Commons Attribution-ShareAlike 4.0 International License&lt;/a&gt;.

.bottom_abs.width100[

Author: XITONG HE

]


]]



&lt;div class="column transition monash-m-new delay-0s" style="clip-path:url(#swipe__clip-path);"&gt;
&lt;div class="background-image" style="background-image:url('images/large.png');background-position: center;background-size:cover;margin-left:3px;"&gt;
&lt;svg class="clip-svg absolute"&gt;
&lt;defs&gt;
&lt;clipPath id="swipe__clip-path" clipPathUnits="objectBoundingBox"&gt;
&lt;polygon points="0.5745 0, 0.5 0.33, 0.42 0, 0 0, 0 1, 0.27 1, 0.27 0.59, 0.37 1, 0.634 1, 0.736 0.59, 0.736 1, 1 1, 1 0, 0.5745 0" /&gt;
&lt;/clipPath&gt;
&lt;/defs&gt;	
&lt;/svg&gt;
&lt;/div&gt;
&lt;/div&gt;

---
# Supplementary slides

---
# Model performace

- Calibration plot
&lt;br&gt;
	- Only the first and last bins deviated from 45 degree line, and the rest seemed to fit well.
	- Unstable situation for the extreme value
 
&lt;center&gt;
 
![](project_presentation_files/figure-html/unnamed-chunk-2-1.png)&lt;!-- --&gt;

---
# Baysian Paired Comparison Model
In order to capture the head-to-head effect in each pair of player, the bayesian inference is introduced in this case

`\(P(w|D)=\frac{P(D|w)P(w)}{P(D)} \propto P(D|w)P(w)\)`
&lt;details  style="padding-left:40px;font-size:18pt"&gt;
&lt;summary&gt;Parameter details&lt;/summary&gt;
&lt;ul&gt;
&lt;li&gt;\(D\) is a set of outcomes D but a single outcome will be given the notation r, &lt;/li&gt;
&lt;li&gt;\(P(w|D)\) is the posterior probability, &lt;/li&gt;
&lt;li&gt;\(P(D|w)\) is the likelihood of the model given the data,&lt;/li&gt;
&lt;li&gt;\(P(w)\) is the prior probability,assumed in this case: \(w_{std} \sim N(0,1)\);\(w \sim N(0,w_{std}^2)\)&lt;/li&gt;
&lt;li&gt;\(P(D)\) is marginal likelihood of the model found through normalisation.&lt;/li&gt;
&lt;/ul&gt;
&lt;/details&gt;
&lt;br&gt;
Applying Bayesian method in Bradley Terry Model:

`\(P(r_{ij}=1|\lambda_{i},\lambda_{j})=\frac{exp(\lambda_{i})}{exp(\lambda_{i})+exp(\lambda_{j})}=\frac{1}{1+e^{-(\lambda_{i}-\lambda_{j})}}=\sigma(\lambda_{i}-\lambda_{j})\)`


&lt;details  style="padding-left:40px;font-size:18pt"&gt;
&lt;summary&gt;Parameter details&lt;/summary&gt;
&lt;ul&gt;
&lt;li&gt;\(r_{ij}=1\) indicates a win for player i against player j, &lt;/li&gt;
&lt;li&gt;\(\lambda_{i};\lambda_{j}\) are the player skills which are the parameters of the model,&lt;/li&gt;
&lt;li&gt;\(\sigma\) iis the logistic sigmoid function: \(\frac{1}{1+e^{-x}}\)&lt;/li&gt;
&lt;/ul&gt;
&lt;/details&gt;

&lt;br&gt;
The likelihood function:
&lt;center&gt;
`\(P(D|w)=\prod_{i = 1}^{N} P(r^i|w)\to P(D|\lambda)=\prod_{i = 1}^{N} \sigma(\lambda_{a}^i-\lambda_{b}^i)\)` 
&lt;center&gt;

given a set of match outcomes D and ability of each player `\(\lambda\)`
---
# Head-To-Head effect 

- In general, the next prediction outcome: `\(r^{n+1}_{ij}\)` is take the expectation of `\(P(r^{n+1}_{ij}|\lambda_{i};\lambda_{j})\)` with the posterior distribution `\(P(\lambda|D)\)` and Using Bayesian inference to approximate the full posterior distribution.
- Implement in Stan with binomial distribution:
&lt;center&gt;
`$$y \sim binomial(n,p)$$`
`$$P_{win_1}=\frac{\exp{(\lambda_1-\lambda_0+\delta_{1,0})}}{1+\exp{(\lambda_{1}-\lambda_{0}+\delta_{1,0})}}$$`
`$$y_{pred}\sim binomial(n,P_{win_1})$$` 
where `\(y\)` is the number of matches of player1 wins
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLanguage": "r",
"highlightLines": true,
"highlightSpans": false,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%/%total%",
"navigation": {
"scroll": false,
"touch": true,
"click": false
},
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'assets/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
